<html><head><title>Permanent Link to Groooooooooooooooooovy</title><meta charset="utf-8"></head><body><h2>Permanent Link to Groooooooooooooooooovy</h2><p>Você tem que alterar os pacotes no import de 1000 arquivos. Opção? <a href="http://web.archive.org/web/20090212110604/http://www.gnu.org/software/sed/sed.html">sed</a>, claro.</p><p>No meu caso, acho que foi mais rápido escrever este scriptizinho em <a href="http://web.archive.org/web/20090212110604/http://groovy.codehaus.org/">groovy </a>do que ler as páginas de manual dos pipelines que teria que fazer.</p><p> <span style="font-family: courier new; color: rgb(102, 102, 0);">#!/usr/bin/env groovy</span></p><p> <span style="font-family: courier new; color: rgb(102, 102, 0);">new File(this.args[0]).eachFileRecurse(){</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> input -&gt;</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> filename = input.getAbsolutePath();</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> output = new File(filename+”.REPLACING”);</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> if(!input.isDirectory() &amp;&amp; (input.getName().matches(”^.*java\$”))){</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> </span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> println(”################# UPDATING FILE [”+ input.getAbsolutePath()+”] ##############################”);</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> input.eachLine{</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> line -&gt; modified = line.replaceAll(this.args[1], (this.args[2]+”\n”));</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> output.append(modified)</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> }</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> }</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> input.delete();</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);"> output.renameTo(new File(filename));</span><br> <span style="font-family: courier new; color: rgb(102, 102, 0);">}</span></p><p>Ele recebe três parâmetros: [0] diretorio onde começar [1] regexp com linha a substituir [2] texto para colocar no lugar. Como sou newbie em <a href="http://web.archive.org/web/20090212110604/http://groovy.codehaus.org/">Groovy</a>, acho que dá pra melhorar muito…sugestões?</p><p>(não o algoritmo em si, eu sei que tá uma merda, mas otimizar script que você vai usar uma vez na vida é um tanto quanto perda de tempo demais para mim, quero saber sintaxe e truques) </p></body></html>