<html><head><title>Permanent Link to Regras são Regras</title><meta charset="utf-8"></head><body><h2>Permanent Link to Regras são Regras</h2><p>E tem gente que questiona porque cosntruir um Domain Model e uma camada de negócios consistente é importante. Leia o <a href="http://web.archive.org/web/20090212105924/http://portaljava.locaweb.com.br/home/modules.php?name=Forums&amp;file=viewtopic&amp;t=18307&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=&amp;sid=447e857d41d19cc1275fd373203c9aaa">post no Portal Java</a> e você vai ver um problema bem interessante.</p><p>No caso específico, alguém implementou regras de negócio em Actions Struts. Muito bom, exceto pelo fato que isso gera: </p><p> Não, escolher outro framework não é a solução (mesmo que seja o Spring). O importante é saber que estas regras devem estar separadas em sua própria camada, modeladas através de objetos de negócio.</p><p>Bom, esse caso específico pede uma medida imediata que evite reescrever a lógica da aplicação toda novamente. Uma soluções é usar adaptadores.</p><p>Se você tem uma <span style="color: rgb(51, 51, 153);font-family:courier new;">AdicionarUsuarioAction</span>, uma <span style="color: rgb(0, 0, 153);font-family:courier new;">RemoverUsuarioAction</span>, por exemplo, pode criar uma interface assim:</p><p><span style="color: rgb(51, 51, 153);font-family:courier new;">public interface GerenciadorUsuario{</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;"> public adicionar(Usuario u);</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;"> public remover(Usuario u);</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;">}</span></p><p>Todo código novo do seu sistema deve usar essa interface. O próximo passo é criar um Adapter para suas Actions, e isso mostra o que o acoplamento faz por você:</p><p><span style="color: rgb(51, 51, 153);font-family:courier new;">public GerenciadorUsuarioAdapter{</span></p><p><span style="color: rgb(51, 51, 153);font-family:courier new;"> public void adicionar(Usuario u){</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;"> RequestAdapter req = new RequestAdapter();</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;"> requestAdapter.setParameter(”login”, usuario.getLogin());</span></p><p><span style="color: rgb(51, 51, 153);font-family:courier new;"> ResponseAdapter resp = new ResponseAdapter();</span></p><p><span style="color: rgb(51, 51, 153);font-family:courier new;"> executarAction(AdicionarUsuario.class, req, resp); </span><br><span style="color: rgb(51, 51, 153);font-family:courier new;"> }</span><br><span style="color: rgb(51, 51, 153);font-family:courier new;">}</span></p><p>Uma bela gambiarra.<span style="color: rgb(51, 51, 255);"> <span style="color: rgb(0, 0, 153);font-family:courier new;">Request</span><span style="color: rgb(51, 102, 255);"> </span></span>e<span style="color: rgb(0, 0, 153);"> </span><span style="color: rgb(51, 51, 255);font-family:courier new;"><span style="color: rgb(0, 0, 153);">ResponseAdapter</span> </span>são implementações do HTTP request e HTTP response. <span style="color: rgb(0, 0, 153);font-family:courier new;">executarAction(Class, HttpRequest, HttpResponse) </span>faz a chamada à Action emulando um ambiente web.</p><p>A melhor solução, <span style="font-weight: bold;">claro</span>, continua sendo refatroar o código e remover a lógica de negócios do Struts. Não, não adianta colcoar esta no WebWork, XWork, Spring… o que importa é colocá-la em um Domain Model consistente e reaproveitável, mas Domain Model é assunto apra outro post. </p></body></html>